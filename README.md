# detector()

1. Это стандартный парсер телеграма по адресу [t.me](https://t.me/).
   Ну, то есть конкретно двух каналов по игре ChatWars [ChatWarsAuction](https://t.me/ChatWarsAuction) и [chatwars3](https://t.me/chatwars3).
   > Данная функция когда-то была частью [нотифай](https://github.com/steve10live/CW-Auction-Notify) бота, по факту таковой и осталась, просто теперь вынесена в отдельный скрипт, чтобы не нагружать память основного бота.
2. __Что он делает?__
   * Первым делом при запуске проверяет доступность каналов (еще и [lot_updater](https://t.me/lot_updater)) и точки отсчета на которой он закончил.
   * И начинает проверять на единицу выше по каналу аукциона с периодичностью где-то 0.4 секунды.
   > Почему так медленно? Ну потому что этот бот проверяет две ссылки в двух потоках с такой скоростью. Это приблизительно равно 300 запросам в минуту, на которые нужно ровняться.
   > Потому что, телеграм перестает возвращать нормальные посты, а только ошибки.
   * Там стоит красивая схема, что если скрипт нашел пост (а раньше его не было), он почти никак его не изменяя (кроме знаков переноса на слеш, а слеш меняет на его html версию), отправит это все на мой специализированный канал - [lot_updater](https://t.me/lot_updater).
   * Но не просто отправит новым сообщением, а изменит старое, которое он проверял при запуске.
   * И так каждый раз, с любым аукционным постом.
3. Звучит _довольно_ бесполезно. Но это не так. На том канале сидят другие боты, которые ловят сигнатуру изменившегося поста и могут уже с этим работать дальше.
4. Собственно с этими сигнатурами как раз и работает следующая функция [oldest](https://github.com/steve10live/oldest).
   > Которая тоже когда-то была частью нотифай бота, но жрала тоже много памяти и была вынесена в отдельного бота, только там уже серьезно и нужна для каждого сервера отдельная.

## Change Log

`18.10.2023` Переход на парсинг с помощью Telethon. Скрипт работает из файла main.py, detector.py сохранён для истории.

`28.11.2022` e-objects 1.2.0 перенесена в functions.py, чтобы не вызывать конфликтов на сервере.

`21.11.2020` Перенес переменные постов на канале [lot_updater](https://t.me/lot_updater) в окружение,
чтобы не выпускать патчи каждый раз когда эти посты нужно поменять.

`12.11.2020` Обновил библиотеку e-objects до версии 1.2.0.

